<html lang="de">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=Edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
  
    <title>slidoo</title>

    <link href="http://fonts.googleapis.com/icon?family=Material%20Icons" rel="stylesheet">
    <!--Import materialize.css-->
    <link type="text/css" rel="stylesheet" href="css/materialize.min.css" media="screen,projection">
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:400,600,700,300' rel='stylesheet' type='text/css'>   
    <script src="http://ajax.googleapis.com/ajax/libs/angularjs/1.4.8/angular.min.js"></script>

    <script src="../sweetalert-master/dist/sweetalert.min.js"></script>
        <link rel="stylesheet" type="text/css" href="../sweetalert-master/dist/sweetalert.css">
    <script src="js/login.js"></script>    
    <!--<script charset="utf-8" src="js/spielplatzanlegendesktop.js"></script> -->
    <script charset="utf-8" src="../www/com/apiomat/apiomat.js"></script>
    
  </head>
   <body ng-app="myApp" ng-controller="DetailSpielplatzCtrl">
 <div class="navbar-fixed">  
  <nav>
    <div class="nav-wrapper">
       <a href="#" class="brand-logo left">
        <img src="bilder/logo.png" height="32px">
        slidoo
      </a>
      <ul id="nav-mobile" class="right hide-on-med-and-down">
          <li class="active"><a href="center.html" class="smoothScroll">Alle Spielpl&auml;tze</a></li>
          <li><a href="create.html" class="smoothScroll">Spielplatz erstellen</a></li>
          <li><a href="index.html" onklick="logout()">Logout</a>
      </ul>
    </div>
  </nav>
 </div>   

<div class="container" style="margin-bottom:8em;">
    
                     
<h1>Spielplatz löschen</h1>
    
<p>Möchten Sie diesen Spielplatz unwiderruflich löschen?</p>
    
        <div ng-repeat="playlistdetail in playlistdetails">
          <div class="card">

                <div class="card-content" style="height:200px;">
                    <div style="float:left;">
                  <img class="responsive-image"style="height:160px; margin-right:25px;" src="../www/img/{{playlistdetail.bild}}">
                </div>
                  <span class="card-title activator grey-text text-darken-4">{{playlistdetail.title}}
                  </span><br/>
                    <div style="float:left; margin-right: 0.1em; "><i class="material-icons" style="font-size:3em;">room</i></div>
                    <div style="float: left;"><p style="">{{playlistdetail.ort}}</p>
                  <p >{{playlistdetail.strasse}} {{playlistdetail.hausnummer}}</p>
                    <p>{{playlistdetail.stadtteil}}</p>
                  <p style="">{{playlistdetail.plz}} Aschaffenburg</p>
                  <p style=""></p>
                  <br/></div>   

                </div>
          </div>
        </div>
          <div class="">
              <button class="btn waves-effect waves-light btn-large orange accent-2" type="submit" name="action" onclick="loeschen()" style="margin-right:1em;">Spielplatz unwiderruflich löschen
            </button>
          <button class="btn waves-effect waves-light btn  btn-large grey lighten-1" type="submit" name="action" onclick="abbrechen()">Abbrechen
            </button>
                  
        </div>

</div >
     <footer class="page-footer  pink darken-1">
          <div class="container">
            <div class="row">
              <div class="col l6 s12">
                <h5 class="white-text">Footer Content</h5>
                <p class="grey-text text-lighten-4">You can use rows and columns here to organize your footer content.</p>
              </div>
             
            </div>
          </div>
          <div class="footer-copyright" style="text-align:center;">
            <div class="container">
            © 2016 Copyright Text
            </div>
          </div>
        </footer>                                   
                   
  </body>
 
  <script type="text/javascript" src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
<script type="text/javascript" src="../www/js/materialize.min.js"></script>
<script> 
    $('select').material_select();
 </script>
<script>

var app = angular.module('myApp', []);
    var user = new Apiomat.User();
    user.setUserName("test23");
    user.setPassword("test23");
    Apiomat.Datastore.configureWithCredentials(user);
 
    var saveCB = {
      onOk: function() {
       
      },
      onError: function(error) {

      }
    };
    user.loadMe({
      onOk: function() {},
      onError: function(error) {
          
        user.save(saveCB);
      }
    });  
    
   
    

app.controller('DetailSpielplatzCtrl', function($scope) {
   var url = window.location.href;
   var id1 = url.substring(url.indexOf('?')+1);
 $scope.playlistdetails = [];
   //DB-verbindung mit Spielplatztabelle
    Apiomat.spielplatz.getspielplatzs("id==id(" + id1 + ")", {
        onOk : function(loadedObjs) {
            //Now you can do sth with loaded objects (loadedObjs)
            var arrayspielplaetze = loadedObjs[0]["data"];
    //Ausgabe in Konsole
    var name = arrayspielplaetze["name"];
        var strasse = arrayspielplaetze["straße"];
        var nummer = arrayspielplaetze["hausnummer"];
        var stadtteil = arrayspielplaetze["stadtteil"];
        var plz = arrayspielplaetze["plz"];
        var bild = arrayspielplaetze["hauptbild"];
       $scope.playlistdetails = [
    { title: name, strasse: strasse, nummer:nummer, stadtteil:stadtteil, plz:plz, bild:bild },
  ];
            $scope.$apply();

},
onError : function(error) {
//handle error
}
})
});
    
function loeschen() {
    
    var myspielplatz;
    var url = window.location.href;
    var id1 = url.substring(url.indexOf('?')+1);
    
    Apiomat.spielplatz.getspielplatzs("id==id(" + id1 + ")", {
      onOk: function(result) {
        myspielplatz = result[0];
        
        myspielplatz.deleteModel({
          onOk: function() {
            swal({ 
                title: "",
                text: "Der Spielplatz wurde erfolgreich gelöscht",
                type: "success",
                confirmButtonColor: "#ff9100", 
              },
              function(){
                window.location.href = 'center.html';
            });
          },
          onError: function(error) {
            console.log(error);
          }
        })
      },
      onError: function(error) {
        console.log(error);
      }
    });
   
}  

    function abbrechen(){
        window.location.href = "center.html";
    }
    

  </script>
    
</html>