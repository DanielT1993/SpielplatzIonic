<html lang="de">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=Edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <title>slidoo</title>

        <link href="http://fonts.googleapis.com/icon?family=Material%20Icons" rel="stylesheet">
        <!--Import materialize.css-->
        <link type="text/css" rel="stylesheet" href="css/materialize.min.css" media="screen,projection">
        <link href='http://fonts.googleapis.com/css?family=Open+Sans:400,600,700,300' rel='stylesheet' type='text/css'>   
        <script src="http://ajax.googleapis.com/ajax/libs/angularjs/1.4.8/angular.min.js"></script>

        <script src="../sweetalert-master/dist/sweetalert.min.js"></script>
        <link rel="stylesheet" type="text/css" href="../sweetalert-master/dist/sweetalert.css">
        <script src="js/login.js"></script>    
        <!--<script charset="utf-8" src="js/spielplatzanlegendesktop.js"></script> -->
        <script charset="utf-8" src="../www/com/apiomat/apiomat.js"></script>

    </head>
    <body ng-app="myApp" ng-controller="DetailSpielplatzCtrl">
         <div class="navbar-fixed">  
          <nav>
            <div class="nav-wrapper">
               <a href="#" class="brand-logo left">
                <img src="bilder/logo.png" height="32px">
                slidoo
              </a>
              <ul id="nav-mobile" class="right hide-on-med-and-down">
                  <li class="active"><a href="center.html" class="smoothScroll">Alle Spielpl&auml;tze</a></li>
                  <li><a href="create.html" class="smoothScroll">Spielplatz erstellen</a></li>
                  <li><a href="index.html" onklick="logout()">Logout</a>
              </ul>
            </div>
          </nav>
         </div>   

  
 
    <div class="container">
        <div class="nav-wrapper" style="margin-top:2em">
      <div class="col s12">
          <div style="float:left"><a href="center.html" class="breadcrumb">Alle Spielplätze </a></div> 
          <div style="float:left; margin-left:0.5em; color:#757575;"><i class="tiny material-icons" style="padding-top:0.25em; margin-right:0.5em;">play_arrow</i></div>
          <div style="margin-left:1em; color:#757575; font-size:14px;">Spielplatz bearbeiten - {{spName}} </div>
      </div>
    </div>

  
    <h1>Spielplatz bearbeiten</h1>  
    <div class="card" class="z-depth-5">                     
    <form class="col s12" >
                          <h2>Location</h2>

                          <div class="row">
                            <div class="input-field col s12">
                                <input id="spielplatzname" type="text" class="validate" value="{{spName}}">
                              <label>Name</label>
                            </div>
                          </div>

                          <div class="row">
                            <div class="input-field col s6">
                                 <label >Straße</label>
                              <input id="spielplatzstraße" type="text" class="validate" value="{{spStrasse}}" >
                             
                            </div>
                              <div class="input-field col s6">
                                  <label >Hausnummer</label>
                              <input id="hausnummer" type="number" class="validate" value="{{spHausnr}}">
                              
                            </div>
                            </div>

                            <div class="row">  
                                <div class="input-field col s6">
                                  <input id="plz" type="number" class="validate" value="{{spPlz}}">
                                  <label >Postleitzahl</label>
                                </div>
                                    <div class="input-field col s6">
                                    <select id="stadtteil">
                                        <option  value="1" >Gailbach</option>
                                        <option  value="2">Nilkheim</option>
                                        <option  value="3" >Obernau</option>
                                        <option  value="4">Schweinheim</option>
                                        <option  value="5">Strietwald</option>
                                    </select>
                                    <label>Stadtteil</label>
                                </div>
                            </div>                    
                          <h2>Struktur</h2> 
                            <div class="row">
                             <div class="input-field col s6">
                                <select id="alter">
                                  <option  value="1">Bis 5 Jahre</option>
                                  <option  value="2">Bis 10 Jahre</option>
                                  <option  value="3">Bis 15 Jahre</option>
                                </select>
                                <label>Altersgruppe</label>
                                                    </div>
                                <div class="input-field col s6">
                                <select id="sitzgelegenheiten">
                                  <option  value="1">Für bis zu 5 Personen</option>
                                  <option  value="2">Für bis zu 15 Personen</option>
                                  <option  value="3">für mehr als 20 Personen</option>
                                </select>
                                <label>Anzahl Sitzgelegenheiten</label>
                            </div>
                          </div>
                          <div class="row">
                              <div class="input-field col s6">
                              <input id="groesse" type="number" class="validate" value="{{spGroesse}}">
                              <label >Größe in m2</label>
                            </div>
                            <div class="input-field col s6">
                            <select id="status">
                              <option value="1">Bespielbar</option>
                              <option value="2">Nicht bespielbar</option>
                            </select>
                            <label>Status</label>
                          </div>

                          </div>
                            <h2>Ausstattung</h2> 
                            <div class="row" >

                                <div class="input-field col s4">
                                    <input type="checkbox" class="filled-in" id="sanitar"/>
                                    <label for="sanitar">Sanitäranlagen</label>
                                </div>
                                <div class="input-field col s4">
                                    <input type="checkbox" class="filled-in" id="grillplatz"/>
                                    <label for="grillplatz">Grillplatz</label>
                                </div>
                            </div>
                           <br/>
                            <h2>Spielgeräte</h2> 
                            <div class="row" >
                                <div class="input-field col s4">
                                    <input type="checkbox" class="filled-in" id="rutsche" />
                                    <label for="rutsche">Rutsche</label>
                                </div>
                                <div class="input-field col s4">
                                    <input type="checkbox" class="filled-in" id="kletterturm" />
                                    <label for="kletterturm">Kletterturm</label>
                                </div>
                                <div class="input-field col s4">
                                    <input type="checkbox" class="filled-in" id="wippe" />
                                    <label for="wippe">Wippe</label>
                                </div>
                            </div>
                            <div class="row" >
                                <div class="input-field col s4">
                                    <input type="checkbox" class="filled-in" id="ballsport" />
                                    <label for="ballsport">Ballsport</label>
                                </div>
                                <div class="input-field col s4">
                                    <input type="checkbox" class="filled-in" id="tischtennis" />
                                    <label for="tischtennis">Tischtennis</label>
                                </div>
                                <div class="input-field col s4">
                                    <input type="checkbox" class="filled-in" id="schaukel" />
                                    <label for="schaukel">Schaukel</label>
                                </div>
                            </div>

                              <div class="row" >
                                <div class="input-field col s4">
                                    <input type="checkbox" class="filled-in" id="sandkasten" />
                                    <label for="sandkasten">Sandkasten</label>
                                </div>
                                <div class="input-field col s4">
                                    <input type="checkbox" class="filled-in" id="wasserspiele" />
                                    <label for="wasserspiele">Wasserspiele</label>
                                </div>
                                  <div class="input-field col s4">
                                    <input type="checkbox" class="filled-in" id="klettergerust" />
                                    <label for="klettergerust">Klettergerüst</label>
                                </div>
                            </div>
                                <div class="row" >
                                    <div class="input-field col s4">
                                    <input type="checkbox" class="filled-in" id="seilbahn" />
                                    <label for="seilbahn">Seilbahn</label>
                                </div>
                                <div class="input-field col s4">
                                    <input type="checkbox" class="filled-in" id="spielobjekt" />
                                    <label for="spielobjekt">Spielobjekt</label>
                                </div>
                                <div class="input-field col s4">
                                    <input type="checkbox" class="filled-in" id="sonstiges" />
                                    <label for="sonstiges">Sonstiges</label>
                                </div>
                            </div>
                            <br/>
                            <h2>Bildupload</h2>  
                            <form action="#">
                              <div class="file-field input-field">
                                <div class="btn orange accent-3">
                                  <span>File</span>
                                  <input type="file" multiple>
                                </div>
                                <div class="file-path-wrapper">
                                  <input class="file-path validate" id="bild" type="text" value="{{spBild}}">
                                </div>
                              </div>
                            </form>
                        </form>
                      </div>

                    <div style="margin-bottom:5em;">
                            <button class="btn waves-effect waves-light btn  btn-large  orange accent-2" type="submit" name="action" onclick="aendern()">Änderungen speichern
                            </button>
                    </div>
        </div>  
        <footer class="page-footer  pink darken-1" style="margin-top:5em;">
          <div class="footer-copyright" style="text-align:center;">
            <div class="container">
            © 2016 Slidoo | Rotaract Deutschland - Partner von Rotary
            </div>
          </div>
        </footer>  
  </body>
<script type="text/javascript" src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
<script type="text/javascript" src="../www/js/materialize.min.js"></script>
 <script src="http://maps.googleapis.com/maps/api/js?key=AIzaSyCmpTMw7IitqkPCAfwlwsZGd6cruNNLLnY"></script>

<script>

var app = angular.module('myApp', []);
    var user = new Apiomat.User();
    user.setUserName("test23");
    user.setPassword("test23");
    Apiomat.Datastore.configureWithCredentials(user);
 
    var saveCB = {
      onOk: function() {
       
      },
      onError: function(error) {

      }
    };
    user.loadMe({
      onOk: function() {},
      onError: function(error) {
          
        user.save(saveCB);
      }
    }); 
     $('#stadtteil>option:eq(3)').prop('selected', true);
app.controller('DetailSpielplatzCtrl', function($scope) {
    $('select').material_select();
    $scope.spName = " ";
    $scope.spStrasse = " ";
    $scope.spHausnr = 0;
    $scope.spPlz = 0;
    $scope.spGroesse = 0;
    $scope.spBild = " ";
   
    var url = window.location.href;
    var id1 = url.substring(url.indexOf('?')+1);
    $scope.playlistdetails = [];
   //DB-verbindung mit Spielplatztabelle
    Apiomat.spielplatz.getspielplatzs("id==id(" + id1 + ")", {
        onOk : function(loadedObjs) {
            //Now you can do sth with loaded objects (loadedObjs)
            var arrayspielplaetze = loadedObjs[0]["data"];
    //Ausgabe in Konsole
    var name = arrayspielplaetze["name"];
    var spHausnr = arrayspielplaetze["hausnummer"];
    var spStrasse = arrayspielplaetze["straße"];
    var spPlz = arrayspielplaetze["plz"];
    var spGroesse = arrayspielplaetze["größe"];
    var spSanitar = arrayspielplaetze["sanitäranlagen"];
    var spGrillen = arrayspielplaetze["grillplatz"];
    var spRutsche = arrayspielplaetze["rutsche"];
    var spKletterturm = arrayspielplaetze["kletterturm"];
    var spWippe = arrayspielplaetze["wippe"];
    var spBallsport = arrayspielplaetze["ballsport"];
    var spTischtennis = arrayspielplaetze["tischtennis"];
    var spSchaukel = arrayspielplaetze["schaukel"];
    var spSandkasten = arrayspielplaetze["sandkasten"];
    var spWasserspiele = arrayspielplaetze["wasserspiele"];
    var spKlettergerust = arrayspielplaetze["klettergerüst"];
    var spSeilbahn = arrayspielplaetze["seilbahn"];
    var spSpielobjekt = arrayspielplaetze["spielobjekt"];
    var spSonstiges = arrayspielplaetze["sonstiges"];
    var spBild = arrayspielplaetze["hauptbild"];
     
    $scope.spName = name;
    $scope.spStrasse = spStrasse;
    $scope.spHausnr = spHausnr;
    $scope.spPlz = spPlz;
    $scope.spGroesse = spGroesse;
     $scope.spBild = spBild;
    
    if (spSanitar == "sanitar.png"){
        $("#sanitar").prop("checked", true); 
    }else{
        $("#sanitar").prop("checked", false);};    
    if (spGrillen == "grillplatz.png"){
        $("#grillplatz").prop("checked", true); 
        
    }else{
        $("#grillplatz").prop("checked", false);};
     if (spRutsche == "rutsche.png"){
        $("#rutsche").prop("checked", true); 
    }else{
        $("#rutsche").prop("checked", false);};   
    if (spKletterturm == "kletterturm.png"){
        $("#kletterturm").prop("checked", true); 
    }else{
        $("#kletterturm").prop("checked", false);}; 
    if (spWippe == "wippe.png"){
        $("#wippe").prop("checked", true); 
    }else{
        $("#wippe").prop("checked", false);};
    if (spBallsport == "ballspielfeld.png"){
        $("#ballsport").prop("checked", true); 
    }else{
        $("#ballsport").prop("checked", false);}; 
    if (spTischtennis == "tischtennisplatte.png"){
        $("#tischtennis").prop("checked", true); 
    }else{
        $("#tischtennis").prop("checked", false);}; 
    if (spSchaukel == "schaukel.png"){
        $("#schaukel").prop("checked", true); 
    }else{
        $("#schaukel").prop("checked", false);};
    if (spSandkasten == "sandkasten.png"){
        $("#sandkasten").prop("checked", true); 
    }else{
        $("#sandkasten").prop("checked", false);};
    if (spWasserspiele == "wasserspielplatz.png"){
        $("#wasserspiele").prop("checked", true); 
    }else{
        $("#wasserspiele").prop("checked", false);};
    if (spKlettergerust == "klettergeruest.png"){
        $("#klettergerust").prop("checked", true); 
    }else{
        $("#klettergerust").prop("checked", false);};
    if (spSeilbahn == "seilbahn.png"){
        $("#seilbahn").prop("checked", true); 
    }else{
        $("#seilbahn").prop("checked", false);};
    if (spSpielobjekt == "spielobjekt.png"){
        $("#spielobjekt").prop("checked", true); 
    }else{
        $("#spielobjekt").prop("checked", false);};
    if (spSonstiges == "sonstiges.png"){
        $("#sonstiges").prop("checked", true); 
    }else{
        $("#sonstiges").prop("checked", false);};
    $scope.$apply();
},
onError : function(error) {
//handle error
}
})
});

function aendern() {
    
    var myspielplatz;
    var url = window.location.href;
    var id1 = url.substring(url.indexOf('?')+1);
    var spielplatzstrasse = document.getElementById("spielplatzstraße").value;
    var spielplatzhausnr = document.getElementById("hausnummer").value;
    var spielplatzplz = document.getElementById("plz").value;    
    
    var geocoder = new google.maps.Geocoder();
    var address = plz + " aschaffenburg " + spielplatzstrasse + " " + spielplatzhausnr ;
    var spielplatzlatitude;
    var spielplatzlongitude;    
    geocoder.geocode( { 'address': address}, function(results, status) {

    if (status == google.maps.GeocoderStatus.OK) {
            spielplatzlatitude = results[0].geometry.location.lat();
            spielplatzlongitude = results[0].geometry.location.lng();
            console.log(spielplatzlatitude);
            console.log(spielplatzlongitude);
            console.log(spielplatzlatitude);
            console.log(spielplatzlongitude);
            console.log(spielplatzlatitude);
            console.log(spielplatzlongitude);
        } 
    }) 
    var spielplatzname = document.getElementById("spielplatzname").value;
    var spielplatzstadtteil = document.getElementById("stadtteil").value;
    var spielplatzalter = document.getElementById("alter").value;
    var spielplatzsitz = document.getElementById("sitzgelegenheiten").value;
    var spielplatzgroesse = document.getElementById("groesse").value;
    var spielplatzstatus = document.getElementById("status").value;
    var spielplatzrutsche = document.getElementById("rutsche").checked;
    var spielplatzkletterturm = document.getElementById("kletterturm").checked;   
    var spielplatzwippe = document.getElementById("wippe").checked;   
    var spielplatzballsport = document.getElementById("ballsport").checked;   
    var spielplatztischtennis = document.getElementById("tischtennis").checked;
    var spielplatzschaukel = document.getElementById("schaukel").checked;  
    var spielplatzsandkasten = document.getElementById("sandkasten").checked;  
    var spielplatzwasserspiele = document.getElementById("wasserspiele").checked; 
    var spielplatzklettergerust = document.getElementById("klettergerust").checked; 
    var spielplatzseilbahn = document.getElementById("seilbahn").checked;
    var spielplatzspielobjekt = document.getElementById("spielobjekt").checked; 
    var spielplatzsonstiges = document.getElementById("sonstiges").checked;  
    var spielplatzsanitar = document.getElementById("sanitar").checked; 
    var spielplatzgrillplatz = document.getElementById("grillplatz").checked;
    var spielplatzbild = document.getElementById("bild").value;
    
    Apiomat.spielplatz.getspielplatzs("id==id(" + id1 + ")", {
      onOk: function(result) {
        myspielplatz = result[0];
        myspielplatz.setName(spielplatzname);
        myspielplatz.setStraße(spielplatzstrasse);
        myspielplatz.setHausnummer(spielplatzhausnr);
        myspielplatz.setPlz(spielplatzplz);
        myspielplatz.setGröße(spielplatzgroesse);
        myspielplatz.setHauptbild(spielplatzbild);

        if(spielplatzstadtteil == 1){
            myspielplatz.setStadtteil("Gailbach");}
        if(spielplatzstadtteil == 2){
            myspielplatz.setStadtteil("Nilkheim");}
        if(spielplatzstadtteil == 3){
            myspielplatz.setStadtteil("Obernau");}
        if(spielplatzstadtteil == 4){
            myspielplatz.setStadtteil("Schweinheim");}
        if(spielplatzstadtteil == 5){
            myspielplatz.setStadtteil("Strietwald");}
          
        if(spielplatzalter == 1){
            myspielplatz.setAltersgruppe("Bis 5 Jahre");}
        if(spielplatzalter == 2){
            myspielplatz.setAltersgruppe("Bis 10 Jahre");}
        if(spielplatzalter == 3){
            myspielplatz.setAltersgruppe("Bis 15 Jahre");}
          
        if(spielplatzsitz == 1){
            myspielplatz.setSitzgelegenheiten("Für bis zu 5 Personen");}
        if(spielplatzsitz == 2){
            myspielplatz.setSitzgelegenheiten("Für bis zu 10 Personen");}
        if(spielplatzsitz == 3){
            myspielplatz.setSitzgelegenheiten("Für mehr als 20 Personen");}
          
        if(spielplatzstatus == 1){
            myspielplatz.setStatus("Bespielbar");}
        if(spielplatzstatus == 2){
            myspielplatz.setStatus("Nicht bespielbar");}

         if(spielplatzrutsche == true){
            myspielplatz.setRutsche("rutsche.png");} 
        else{
             myspielplatz.setRutsche("rutscheinaktiv.png");     
            }
        if(spielplatzkletterturm == true){
            myspielplatz.setKletterturm("kletterturm.png");} 
        else{
             myspielplatz.setKletterturm("kletterturminaktiv.png");     
            }
        if(spielplatzwippe == true){
            myspielplatz.setWippe("wippe.png");} 
        else{
             myspielplatz.setWippe("wippeinaktiv.png");     
            }
         if(spielplatzballsport == true){
            myspielplatz.setBallsport("ballspielfeld.png");} 
        else{
             myspielplatz.setBallsport("ballspielfeldinaktiv.png");     
            }
        if(spielplatztischtennis == true){
            myspielplatz.setTischtennis("tischtennisplatte.png");} 
        else{
             myspielplatz.setTischtennis("tischtennisplatteinaktiv.png");     
            }
        if(spielplatzschaukel == true){
            myspielplatz.setSchaukel("schaukel.png");} 
        else{
             myspielplatz.setSchaukel("schaukelinaktiv.png");     
            }
        if(spielplatzsandkasten == true){
            myspielplatz.setSandkasten("sandkasten.png");} 
        else{
             myspielplatz.setSandkasten("sandkasteninaktiv.png");     
            }
        if(spielplatzwasserspiele == true){
            myspielplatz.setWasserspiele("wasserspielplatz.png");} 
        else{
             myspielplatz.setWasserspiele("wasserspielplatzinaktiv.png");     
            }
        if(spielplatzklettergerust == true){
            myspielplatz.setKlettergerüst("klettergeruest.png");} 
        else{
             myspielplatz.setKlettergerüst("klettergeruestinaktiv.png");     
            }
        if(spielplatzseilbahn == true){
            myspielplatz.setSeilbahn("seilbahn.png");} 
        else{
             myspielplatz.setSeilbahn("seilbahninaktiv.png");     
            }
        if(spielplatzspielobjekt == true){
            myspielplatz.setSpielobjekt("spielobjekt.png");} 
        else{
             myspielplatz.setSpielobjekt("spielobjektinaktiv.png");     
            }
          if(spielplatzsonstiges == true){
            myspielplatz.setSonstiges("sonstiges.png");} 
        else{
             myspielplatz.setSonstiges("sonstigesinaktiv.png");     
            }
        if(spielplatzsanitar == true){
            myspielplatz.setSanitäranlagen("sanitar.png");} 
        else{
             myspielplatz.setSanitäranlagen("sanitarinaktiv.png");     
            }
          if(spielplatzgrillplatz == true){
            myspielplatz.setGrillplatz("grillplatz.png");} 
        else{
             myspielplatz.setGrillplatz("grillplatzinaktiv.png");     
            }
        myspielplatz.setLatitude(spielplatzlatitude);
        myspielplatz.setLongitude(spielplatzlongitude);
        myspielplatz.save({
          onOk: function() {
           swal({ 
                title: "",
                text: "Ihre Änderung wurden erfolgreich gespeichert!",
                type: "success", 
                confirmButtonColor: "#ff9100", 
                  },
                  function(){
                    window.location.href = 'center.html';
                });
          },
          onError: function(error) {
            console.log(error);
          }
        })
      },
      onError: function(error) {
        console.log(error);
      }
    });
   
}
</script>
    
</html>